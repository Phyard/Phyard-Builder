<?xml version="1.0" encoding="utf-8"?>
<!-- Simple custom MXML TitleWindow component.
     The TitleWindowApp application displays this component. 
     You cannot run it independently. -->
     
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" 
    title="Save World" width="500">

   <mx:VBox width="100%" verticalAlign="bottom">
      <mx:Text id="Text_TutorialLink" width="100%" selectable="true" link="OnClickTutorialLink(event)">
         <mx:htmlText><![CDATA[<li>Please at least backup the source code for later modifications.</li><li><u><font color='#0000FF'><a href='event:#'>Tutorials on how to use these codes in your blogs and webpages.</a></font></u></li>]]></mx:htmlText>
      </mx:Text >
   </mx:VBox>

   <mx:HBox width="100%" verticalAlign="bottom">
      <mx:Label id="Label_SourceCode" text="Source Code:" fontWeight="bold"/>
      <mx:Spacer width="100%"/>
      <mx:Button label="Copy Source Code" click="OnClickCopySourceCode ();"/>
   </mx:HBox>

   <mx:HBox width="100%" verticalAlign="top">
      <mx:TextArea id="TextArea_SourceCode" width="100%" height="150" editable="true" wordWrap="false">
         <mx:text>
         </mx:text>
      </mx:TextArea>
   </mx:HBox>

   <mx:HBox width="100%" verticalAlign="bottom">
      <mx:Label id="Label_PlayCode" text="Play Code:" fontWeight="bold"/>
      <mx:Spacer width="100%"/>
      <mx:Button label="Copy Play Code" click="OnClickCopyPlayCode ();"/>
   </mx:HBox>

   <mx:HBox width="100%" verticalAlign="top">
      <mx:TextArea id="TextArea_PlayCode" width="100%" height="30" editable="false">
         <mx:text>
         </mx:text>
      </mx:TextArea>
   </mx:HBox>

   <mx:HBox width="100%" verticalAlign="bottom">
      <mx:Label id="Label_EmbedCode" text="Html Embed Code:" fontWeight="bold"/>
      <mx:Spacer width="100%"/>
      <mx:Button label="Copy Embed Code" click="OnClickCopyEmbedCode ();"/>
   </mx:HBox>

   <mx:HBox width="100%" verticalAlign="top">
      <mx:TextArea id="TextArea_EmbedCode" width="100%" height="60" editable="false">
         <mx:text>
         </mx:text>
      </mx:TextArea>
   </mx:HBox>

  <mx:Spacer height="10"/>
   
   <mx:HBox width="100%" verticalAlign="bottom">
      <mx:Spacer width="100%"/>
      <mx:Button label="Close" click="OnClickCloseButton ();"/>
      <mx:Spacer width="100%"/>
   </mx:HBox>
   
   
   <mx:Script>
     <![CDATA[       
         
         import flash.events.TextEvent;
         
         import flash.system.System;
         
         import mx.managers.PopUpManager;
         
         import com.tapirgames.util.UrlUtil;
         
         import common.Define;
         
         private var OnClose:Function = null;
         
         public function SetValues (values:Object):void
         {
            TextArea_SourceCode.text = values.mXmlString;
            TextArea_PlayCode.text = values.mHexString;
            
            var embedCode:String = 
"<object classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\"600\" height=\"600\">\n"
+ 
"<param name=\"FlashVars\" value=\"playcode=" + values.mHexString + "\" />\n"
+
"<param name=\"movie\" value=\"http://swfs.colorinfection.com/player.swf\" />\n"
+
"<param name=\"quality\" value=\"high\" />\n"
+
"<embed src=\"http://swfs.colorinfection.com/player.swf\"\n"
+
"  width=\"600\" height=\"600\"\n"
+
"  FlashVars=\"playcode=" + values.mHexString + "\"\n"
+
"  quality=\"high\"\n"
+
"  type=\"application/x-shockwave-flash\"\n"
+
"  pluginspage=\"http://www.adobe.com/go/getflashplayer\">\n"
+
"</embed>\n"
+
"</object>\n"
;

            
            TextArea_EmbedCode.text = embedCode;
         }
         
         public function SetCloseFunc (onClose:Function):void
         {
            OnClose = onClose;
         }
         
         private function OnClickCloseButton():void 
         {
             PopUpManager.removePopUp(this);
             
             if (OnClose != null)
               OnClose ();
         }
         
         private function OnClickCopySourceCode ():void
         {
            System.setClipboard(TextArea_SourceCode.text);
         }
         
         private function OnClickCopyPlayCode ():void
         {
            System.setClipboard(TextArea_PlayCode.text);
         }
         
         private function OnClickCopyEmbedCode ():void
         {
            System.setClipboard(TextArea_EmbedCode.text);
         }
         
         private function OnClickTutorialLink (event:TextEvent):void
         {
            UrlUtil.PopupPage (Define.EmbedTutorialUrl);
         }
         
         
     ]]>
   </mx:Script>
   
   

</mx:TitleWindow>